/*
 Closure table (transitive closure) for role hierarchy.
 Each row means: ancestorId is an ancestor of descendantId with distance `depth`.
 - depth = 0 => ancestor == descendant (self-link)
 - depth = 1 => direct parent -> child
 - depth > 1 => ancestor several levels above
*/
model RoleClosure {
  id           String   @id @default(uuid(7))
  ancestorId   String
  descendantId String
  depth        Int      // 0 = same node, 1 = direct parent->child, ...
  createdAt    DateTime @default(now())

  ancestor   Role @relation("ancestor", fields: [ancestorId], references: [id], onDelete: Cascade)
  descendant Role @relation("descendant", fields: [descendantId], references: [id], onDelete: Cascade)

  @@unique([ancestorId, descendantId])
  @@index([descendantId])
  @@index([ancestorId])
}