
model TonKho {
  // Bảng tồn kho: số lượng hiện có theo kho/vị trí/sản phẩm/lô/serial
  id         String    @id @default(uuid(7))
  khoId      String
  viTriKhoId String?
  sanPhamId  String
  soLo       String?   @db.VarChar(100)
  hanSuDung  DateTime?
  soSerial   String?   @db.VarChar(100)
  soLuong    Decimal   @default(0) @db.Decimal(18, 3)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  createdBy String?  @db.VarChar(255)
  updatedBy String?  @db.VarChar(255)
  isDelete  Boolean  @default(false)

  kho      Kho       @relation(fields: [khoId], references: [id])
  viTriKho ViTriKho? @relation(fields: [viTriKhoId], references: [id])
  sanPham  SanPham   @relation(fields: [sanPhamId], references: [id])

  @@index([khoId, viTriKhoId, sanPhamId])
  @@index([sanPhamId, soLo, soSerial])
}