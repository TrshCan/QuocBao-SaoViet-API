// Prisma schema - minimal template
generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

generator dbml {
  provider = "prisma-dbml-generator"
  output   = "../documents/ERD.dbml"
}

generator openapi {
  provider    = "prisma-openapi"
  output      = "../documents/openapi"
  title       = "Saoviet API"
  description = "API for my application"
}

datasource db {
  provider = "postgresql"
}

// Enum cho trạng thái người dùng
enum UserStatus {
  active
  inactive
  suspended
}

enum TrangThaiNhap {
  DRAFT
  DONE
}

// Nhóm trường audit chuẩn (theo quy ước)
// - createdAt/updatedAt: mốc thời gian tạo/cập nhật
// - createdBy/updatedBy: người tạo/cập nhật (tham chiếu User.id – có thể để trống giai đoạn đầu)
// - isDelete: cờ xoá mềm (True = ẩn trên UI, không hiển thị trong danh sách)

model TrangThaiChuyen {
  // Danh mục trạng thái (ví dụ cho xuất/chuyển) — có thể mở rộng theo nghiệp vụ
  id  String @id @default(uuid(7))
  ten String
}

model TrangThaiXuat {
  id  String @id @default(uuid(7))
  ten String
}

model ChucNang {
  // Chức năng (module/tính năng hệ thống)
  id          String  @id @default(uuid(7))
  tenChucNang String
  description String? @db.VarChar(255)

  phanQuyens PhanQuyen[]
}

model PhanQuyen {
  // Phân quyền theo chức năng cho người dùng
  id          String @id @default(uuid(7))
  chucNangId  String
  nguoiDungId String
  view        Int    @default(0)
  insert      Int    @default(0)
  update      Int    @default(0)
  delete      Int    @default(0)

  chucNang  ChucNang @relation(fields: [chucNangId], references: [id])
  nguoiDung User     @relation(fields: [nguoiDungId], references: [id])

  @@unique([chucNangId, nguoiDungId])
}
